{"check_type": "terraform", "results": {"passed_checks": [{"check_id": "CKV_AWS_46", "bc_check_id": "BC_AWS_SECRETS_1", "check_name": "Ensure no hard-coded secrets exist in EC2 user data", "check_result": {"result": "PASSED", "evaluated_keys": ["user_data"]}, "code_block": [[37, "resource \"aws_instance\" \"instance1\" {\n"], [38, "  ami           = \"ami-0c55b159cbfafe1f0\"\n"], [39, "  instance_type = \"t2.micro\"\n"], [40, "  subnet_id     = aws_vpc.main.id\n"], [41, "\n"], [42, "  tags = {\n"], [43, "    Name = \"vulnerable-instance-1\"\n"], [44, "  }\n"], [45, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "C:\\Users\\pavan\\OneDrive\\Documents\\ATU\\thesis-practice\\terraform_thesis\\main.tf", "repo_file_path": "/terraform_thesis/main.tf", "file_line_range": [37, 45], "resource": "aws_instance.instance1", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.EC2Credentials", "fixed_definition": null, "entity_tags": {"Name": "vulnerable-instance-1"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/secrets-policies/bc-aws-secrets-1", "details": [], "check_len": null, "definition_context_file_path": "C:\\Users\\pavan\\OneDrive\\Documents\\ATU\\thesis-practice\\terraform_thesis\\main.tf"}, {"check_id": "CKV_AWS_88", "bc_check_id": "BC_AWS_PUBLIC_12", "check_name": "EC2 instance should not have public IP.", "check_result": {"result": "PASSED", "evaluated_keys": ["associate_public_ip_address"]}, "code_block": [[37, "resource \"aws_instance\" \"instance1\" {\n"], [38, "  ami           = \"ami-0c55b159cbfafe1f0\"\n"], [39, "  instance_type = \"t2.micro\"\n"], [40, "  subnet_id     = aws_vpc.main.id\n"], [41, "\n"], [42, "  tags = {\n"], [43, "    Name = \"vulnerable-instance-1\"\n"], [44, "  }\n"], [45, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "C:\\Users\\pavan\\OneDrive\\Documents\\ATU\\thesis-practice\\terraform_thesis\\main.tf", "repo_file_path": "/terraform_thesis/main.tf", "file_line_range": [37, 45], "resource": "aws_instance.instance1", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.EC2PublicIP", "fixed_definition": null, "entity_tags": {"Name": "vulnerable-instance-1"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/public-policies/public-12", "details": [], "check_len": null, "definition_context_file_path": "C:\\Users\\pavan\\OneDrive\\Documents\\ATU\\thesis-practice\\terraform_thesis\\main.tf"}, {"check_id": "CKV_AWS_93", "bc_check_id": "BC_AWS_S3_24", "check_name": "Ensure S3 bucket policy does not lockout all but root user. (Prevent lockouts needing root account fixes)", "check_result": {"result": "PASSED", "evaluated_keys": ["policy"]}, "code_block": [[47, "resource \"aws_s3_bucket\" \"example\" {\n"], [48, "  bucket = \"my-example-bucket\"\n"], [49, "  acl    = \"public-read\"  # Publicly accessible S3 bucket\n"], [50, "\n"], [51, "  tags = {\n"], [52, "    Name = \"vulnerable-bucket\"\n"], [53, "  }\n"], [54, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "C:\\Users\\pavan\\OneDrive\\Documents\\ATU\\thesis-practice\\terraform_thesis\\main.tf", "repo_file_path": "/terraform_thesis/main.tf", "file_line_range": [47, 54], "resource": "aws_s3_bucket.example", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.S3ProtectAgainstPolicyLockout", "fixed_definition": null, "entity_tags": {"Name": "vulnerable-bucket"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/bc-aws-s3-24", "details": [], "check_len": null, "definition_context_file_path": "C:\\Users\\pavan\\OneDrive\\Documents\\ATU\\thesis-practice\\terraform_thesis\\main.tf"}, {"check_id": "CKV_AWS_41", "bc_check_id": "BC_AWS_SECRETS_5", "check_name": "Ensure no hard coded AWS access key and secret key exists in provider", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[3, "provider \"aws\" {\n"], [4, "  region = \"us-west-2\"\n"], [5, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "C:\\Users\\pavan\\OneDrive\\Documents\\ATU\\thesis-practice\\terraform_thesis\\main.tf", "repo_file_path": "/terraform_thesis/main.tf", "file_line_range": [3, 5], "resource": "aws.default", "evaluations": null, "check_class": "checkov.terraform.checks.provider.aws.credentials", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/secrets-policies/bc-aws-secrets-5", "details": [], "check_len": null, "definition_context_file_path": "C:\\Users\\pavan\\OneDrive\\Documents\\ATU\\thesis-practice\\terraform_thesis\\main.tf"}, {"check_id": "CKV_AWS_57", "bc_check_id": "BC_AWS_S3_2", "check_name": "S3 Bucket has an ACL defined which allows public WRITE access.", "check_result": {"result": "PASSED", "entity": {"aws_s3_bucket": {"example": {"__end_line__": 54, "__start_line__": 47, "acl": ["public-read"], "bucket": ["my-example-bucket"], "tags": [{"Name": "vulnerable-bucket"}], "__address__": "aws_s3_bucket.example", "__provider_address__": "aws.default"}}}, "evaluated_keys": ["access_control_policy/grant/*/permission", "access_control_policy/grant", "acl", "access_control_policy", "access_control_policy/grant/*/grantee/uri", "resource_type"]}, "code_block": [[47, "resource \"aws_s3_bucket\" \"example\" {\n"], [48, "  bucket = \"my-example-bucket\"\n"], [49, "  acl    = \"public-read\"  # Publicly accessible S3 bucket\n"], [50, "\n"], [51, "  tags = {\n"], [52, "    Name = \"vulnerable-bucket\"\n"], [53, "  }\n"], [54, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "C:\\Users\\pavan\\OneDrive\\Documents\\ATU\\thesis-practice\\terraform_thesis\\main.tf", "repo_file_path": "/terraform_thesis/main.tf", "file_line_range": [47, 54], "resource": "aws_s3_bucket.example", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Name": "vulnerable-bucket"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/s3-2-acl-write-permissions-everyone", "details": [], "check_len": null, "definition_context_file_path": "C:\\Users\\pavan\\OneDrive\\Documents\\ATU\\thesis-practice\\terraform_thesis\\main.tf"}, {"check_id": "CKV_AWS_19", "bc_check_id": "BC_AWS_S3_14", "check_name": "Ensure all data stored in the S3 bucket is securely encrypted at rest", "check_result": {"result": "PASSED", "entity": {"aws_s3_bucket": {"example": {"__end_line__": 54, "__start_line__": 47, "acl": ["public-read"], "bucket": ["my-example-bucket"], "tags": [{"Name": "vulnerable-bucket"}], "__address__": "aws_s3_bucket.example", "__provider_address__": "aws.default"}}}, "evaluated_keys": ["rule/apply_server_side_encryption_by_default/sse_algorithm", "resource_type", "server_side_encryption_configuration/rule/apply_server_side_encryption_by_default/sse_algorithm"]}, "code_block": [[47, "resource \"aws_s3_bucket\" \"example\" {\n"], [48, "  bucket = \"my-example-bucket\"\n"], [49, "  acl    = \"public-read\"  # Publicly accessible S3 bucket\n"], [50, "\n"], [51, "  tags = {\n"], [52, "    Name = \"vulnerable-bucket\"\n"], [53, "  }\n"], [54, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "C:\\Users\\pavan\\OneDrive\\Documents\\ATU\\thesis-practice\\terraform_thesis\\main.tf", "repo_file_path": "/terraform_thesis/main.tf", "file_line_range": [47, 54], "resource": "aws_s3_bucket.example", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Name": "vulnerable-bucket"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/s3-14-data-encrypted-at-rest", "details": [], "check_len": null, "definition_context_file_path": "C:\\Users\\pavan\\OneDrive\\Documents\\ATU\\thesis-practice\\terraform_thesis\\main.tf"}], "failed_checks": [{"check_id": "CKV_AWS_23", "bc_check_id": "BC_AWS_NETWORKING_31", "check_name": "Ensure every security group and rule has a description", "check_result": {"result": "FAILED", "evaluated_keys": ["egress/[0]", "ingress/[0]"]}, "code_block": [[15, "resource \"aws_security_group\" \"allow_all\" {\n"], [16, "  vpc_id = aws_vpc.main.id\n"], [17, "\n"], [18, "  ingress {\n"], [19, "    from_port   = 0\n"], [20, "    to_port     = 0\n"], [21, "    protocol    = \"-1\"\n"], [22, "    cidr_blocks = [\"0.0.0.0/0\"]  # Overly permissive rule\n"], [23, "  }\n"], [24, "\n"], [25, "  egress {\n"], [26, "    from_port   = 0\n"], [27, "    to_port     = 0\n"], [28, "    protocol    = \"-1\"\n"], [29, "    cidr_blocks = [\"0.0.0.0/0\"]  # Overly permissive rule\n"], [30, "  }\n"], [31, "\n"], [32, "  tags = {\n"], [33, "    Name = \"allow-all\"\n"], [34, "  }\n"], [35, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "C:\\Users\\pavan\\OneDrive\\Documents\\ATU\\thesis-practice\\terraform_thesis\\main.tf", "repo_file_path": "/terraform_thesis/main.tf", "file_line_range": [15, 35], "resource": "aws_security_group.allow_all", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.SecurityGroupRuleDescription", "fixed_definition": null, "entity_tags": {"Name": "allow-all"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/networking-31", "details": [], "check_len": null, "definition_context_file_path": "C:\\Users\\pavan\\OneDrive\\Documents\\ATU\\thesis-practice\\terraform_thesis\\main.tf"}, {"check_id": "CKV_AWS_24", "bc_check_id": "BC_AWS_NETWORKING_1", "check_name": "Ensure no security groups allow ingress from 0.0.0.0:0 to port 22", "check_result": {"result": "FAILED", "evaluated_keys": ["ingress/[0]/from_port", "ingress/[0]/to_port", "ingress/[0]/cidr_blocks", "ingress/[0]/ipv6_cidr_blocks"]}, "code_block": [[15, "resource \"aws_security_group\" \"allow_all\" {\n"], [16, "  vpc_id = aws_vpc.main.id\n"], [17, "\n"], [18, "  ingress {\n"], [19, "    from_port   = 0\n"], [20, "    to_port     = 0\n"], [21, "    protocol    = \"-1\"\n"], [22, "    cidr_blocks = [\"0.0.0.0/0\"]  # Overly permissive rule\n"], [23, "  }\n"], [24, "\n"], [25, "  egress {\n"], [26, "    from_port   = 0\n"], [27, "    to_port     = 0\n"], [28, "    protocol    = \"-1\"\n"], [29, "    cidr_blocks = [\"0.0.0.0/0\"]  # Overly permissive rule\n"], [30, "  }\n"], [31, "\n"], [32, "  tags = {\n"], [33, "    Name = \"allow-all\"\n"], [34, "  }\n"], [35, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "C:\\Users\\pavan\\OneDrive\\Documents\\ATU\\thesis-practice\\terraform_thesis\\main.tf", "repo_file_path": "/terraform_thesis/main.tf", "file_line_range": [15, 35], "resource": "aws_security_group.allow_all", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.SecurityGroupUnrestrictedIngress22", "fixed_definition": null, "entity_tags": {"Name": "allow-all"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/networking-1-port-security", "details": [], "check_len": null, "definition_context_file_path": "C:\\Users\\pavan\\OneDrive\\Documents\\ATU\\thesis-practice\\terraform_thesis\\main.tf"}, {"check_id": "CKV_AWS_25", "bc_check_id": "BC_AWS_NETWORKING_2", "check_name": "Ensure no security groups allow ingress from 0.0.0.0:0 to port 3389", "check_result": {"result": "FAILED", "evaluated_keys": ["ingress/[0]/from_port", "ingress/[0]/to_port", "ingress/[0]/cidr_blocks", "ingress/[0]/ipv6_cidr_blocks"]}, "code_block": [[15, "resource \"aws_security_group\" \"allow_all\" {\n"], [16, "  vpc_id = aws_vpc.main.id\n"], [17, "\n"], [18, "  ingress {\n"], [19, "    from_port   = 0\n"], [20, "    to_port     = 0\n"], [21, "    protocol    = \"-1\"\n"], [22, "    cidr_blocks = [\"0.0.0.0/0\"]  # Overly permissive rule\n"], [23, "  }\n"], [24, "\n"], [25, "  egress {\n"], [26, "    from_port   = 0\n"], [27, "    to_port     = 0\n"], [28, "    protocol    = \"-1\"\n"], [29, "    cidr_blocks = [\"0.0.0.0/0\"]  # Overly permissive rule\n"], [30, "  }\n"], [31, "\n"], [32, "  tags = {\n"], [33, "    Name = \"allow-all\"\n"], [34, "  }\n"], [35, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "C:\\Users\\pavan\\OneDrive\\Documents\\ATU\\thesis-practice\\terraform_thesis\\main.tf", "repo_file_path": "/terraform_thesis/main.tf", "file_line_range": [15, 35], "resource": "aws_security_group.allow_all", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.SecurityGroupUnrestrictedIngress3389", "fixed_definition": null, "entity_tags": {"Name": "allow-all"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/networking-2", "details": [], "check_len": null, "definition_context_file_path": "C:\\Users\\pavan\\OneDrive\\Documents\\ATU\\thesis-practice\\terraform_thesis\\main.tf"}, {"check_id": "CKV_AWS_260", "bc_check_id": "BC_AWS_NETWORKING_67", "check_name": "Ensure no security groups allow ingress from 0.0.0.0:0 to port 80", "check_result": {"result": "FAILED", "evaluated_keys": ["ingress/[0]/from_port", "ingress/[0]/to_port", "ingress/[0]/cidr_blocks", "ingress/[0]/ipv6_cidr_blocks"]}, "code_block": [[15, "resource \"aws_security_group\" \"allow_all\" {\n"], [16, "  vpc_id = aws_vpc.main.id\n"], [17, "\n"], [18, "  ingress {\n"], [19, "    from_port   = 0\n"], [20, "    to_port     = 0\n"], [21, "    protocol    = \"-1\"\n"], [22, "    cidr_blocks = [\"0.0.0.0/0\"]  # Overly permissive rule\n"], [23, "  }\n"], [24, "\n"], [25, "  egress {\n"], [26, "    from_port   = 0\n"], [27, "    to_port     = 0\n"], [28, "    protocol    = \"-1\"\n"], [29, "    cidr_blocks = [\"0.0.0.0/0\"]  # Overly permissive rule\n"], [30, "  }\n"], [31, "\n"], [32, "  tags = {\n"], [33, "    Name = \"allow-all\"\n"], [34, "  }\n"], [35, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "C:\\Users\\pavan\\OneDrive\\Documents\\ATU\\thesis-practice\\terraform_thesis\\main.tf", "repo_file_path": "/terraform_thesis/main.tf", "file_line_range": [15, 35], "resource": "aws_security_group.allow_all", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.SecurityGroupUnrestrictedIngress80", "fixed_definition": null, "entity_tags": {"Name": "allow-all"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/ensure-aws-security-groups-do-not-allow-ingress-from-00000-to-port-80", "details": [], "check_len": null, "definition_context_file_path": "C:\\Users\\pavan\\OneDrive\\Documents\\ATU\\thesis-practice\\terraform_thesis\\main.tf"}, {"check_id": "CKV_AWS_277", "bc_check_id": "BC_AWS_NETWORKING_78", "check_name": "Ensure no security groups allow ingress from 0.0.0.0:0 to port -1", "check_result": {"result": "FAILED", "evaluated_keys": ["ingress/[0]/from_port", "ingress/[0]/to_port", "ingress/[0]/cidr_blocks", "ingress/[0]/ipv6_cidr_blocks"]}, "code_block": [[15, "resource \"aws_security_group\" \"allow_all\" {\n"], [16, "  vpc_id = aws_vpc.main.id\n"], [17, "\n"], [18, "  ingress {\n"], [19, "    from_port   = 0\n"], [20, "    to_port     = 0\n"], [21, "    protocol    = \"-1\"\n"], [22, "    cidr_blocks = [\"0.0.0.0/0\"]  # Overly permissive rule\n"], [23, "  }\n"], [24, "\n"], [25, "  egress {\n"], [26, "    from_port   = 0\n"], [27, "    to_port     = 0\n"], [28, "    protocol    = \"-1\"\n"], [29, "    cidr_blocks = [\"0.0.0.0/0\"]  # Overly permissive rule\n"], [30, "  }\n"], [31, "\n"], [32, "  tags = {\n"], [33, "    Name = \"allow-all\"\n"], [34, "  }\n"], [35, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "C:\\Users\\pavan\\OneDrive\\Documents\\ATU\\thesis-practice\\terraform_thesis\\main.tf", "repo_file_path": "/terraform_thesis/main.tf", "file_line_range": [15, 35], "resource": "aws_security_group.allow_all", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.SecurityGroupUnrestrictedIngressAny", "fixed_definition": null, "entity_tags": {"Name": "allow-all"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/ensure-aws-security-group-does-not-allow-all-traffic-on-all-ports", "details": [], "check_len": null, "definition_context_file_path": "C:\\Users\\pavan\\OneDrive\\Documents\\ATU\\thesis-practice\\terraform_thesis\\main.tf"}, {"check_id": "CKV_AWS_126", "bc_check_id": "BC_AWS_LOGGING_26", "check_name": "Ensure that detailed monitoring is enabled for EC2 instances", "check_result": {"result": "FAILED", "evaluated_keys": ["monitoring"]}, "code_block": [[37, "resource \"aws_instance\" \"instance1\" {\n"], [38, "  ami           = \"ami-0c55b159cbfafe1f0\"\n"], [39, "  instance_type = \"t2.micro\"\n"], [40, "  subnet_id     = aws_vpc.main.id\n"], [41, "\n"], [42, "  tags = {\n"], [43, "    Name = \"vulnerable-instance-1\"\n"], [44, "  }\n"], [45, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "C:\\Users\\pavan\\OneDrive\\Documents\\ATU\\thesis-practice\\terraform_thesis\\main.tf", "repo_file_path": "/terraform_thesis/main.tf", "file_line_range": [37, 45], "resource": "aws_instance.instance1", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.EC2DetailedMonitoringEnabled", "fixed_definition": null, "entity_tags": {"Name": "vulnerable-instance-1"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/ensure-that-detailed-monitoring-is-enabled-for-ec2-instances", "details": [], "check_len": null, "definition_context_file_path": "C:\\Users\\pavan\\OneDrive\\Documents\\ATU\\thesis-practice\\terraform_thesis\\main.tf"}, {"check_id": "CKV_AWS_135", "bc_check_id": "BC_AWS_GENERAL_68", "check_name": "Ensure that EC2 is EBS optimized", "check_result": {"result": "FAILED", "evaluated_keys": ["ebs_optimized"]}, "code_block": [[37, "resource \"aws_instance\" \"instance1\" {\n"], [38, "  ami           = \"ami-0c55b159cbfafe1f0\"\n"], [39, "  instance_type = \"t2.micro\"\n"], [40, "  subnet_id     = aws_vpc.main.id\n"], [41, "\n"], [42, "  tags = {\n"], [43, "    Name = \"vulnerable-instance-1\"\n"], [44, "  }\n"], [45, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "C:\\Users\\pavan\\OneDrive\\Documents\\ATU\\thesis-practice\\terraform_thesis\\main.tf", "repo_file_path": "/terraform_thesis/main.tf", "file_line_range": [37, 45], "resource": "aws_instance.instance1", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.EC2EBSOptimized", "fixed_definition": null, "entity_tags": {"Name": "vulnerable-instance-1"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-ec2-is-ebs-optimized", "details": [], "check_len": null, "definition_context_file_path": "C:\\Users\\pavan\\OneDrive\\Documents\\ATU\\thesis-practice\\terraform_thesis\\main.tf"}, {"check_id": "CKV_AWS_79", "bc_check_id": "BC_AWS_GENERAL_31", "check_name": "Ensure Instance Metadata Service Version 1 is not enabled", "check_result": {"result": "FAILED", "evaluated_keys": ["metadata_options/[0]/http_tokens"]}, "code_block": [[37, "resource \"aws_instance\" \"instance1\" {\n"], [38, "  ami           = \"ami-0c55b159cbfafe1f0\"\n"], [39, "  instance_type = \"t2.micro\"\n"], [40, "  subnet_id     = aws_vpc.main.id\n"], [41, "\n"], [42, "  tags = {\n"], [43, "    Name = \"vulnerable-instance-1\"\n"], [44, "  }\n"], [45, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "C:\\Users\\pavan\\OneDrive\\Documents\\ATU\\thesis-practice\\terraform_thesis\\main.tf", "repo_file_path": "/terraform_thesis/main.tf", "file_line_range": [37, 45], "resource": "aws_instance.instance1", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IMDSv1Disabled", "fixed_definition": null, "entity_tags": {"Name": "vulnerable-instance-1"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-general-31", "details": [], "check_len": null, "definition_context_file_path": "C:\\Users\\pavan\\OneDrive\\Documents\\ATU\\thesis-practice\\terraform_thesis\\main.tf"}, {"check_id": "CKV_AWS_8", "bc_check_id": "BC_AWS_GENERAL_13", "check_name": "Ensure all data stored in the Launch configuration or instance Elastic Blocks Store is securely encrypted", "check_result": {"result": "FAILED", "evaluated_keys": ["root_block_device"]}, "code_block": [[37, "resource \"aws_instance\" \"instance1\" {\n"], [38, "  ami           = \"ami-0c55b159cbfafe1f0\"\n"], [39, "  instance_type = \"t2.micro\"\n"], [40, "  subnet_id     = aws_vpc.main.id\n"], [41, "\n"], [42, "  tags = {\n"], [43, "    Name = \"vulnerable-instance-1\"\n"], [44, "  }\n"], [45, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "C:\\Users\\pavan\\OneDrive\\Documents\\ATU\\thesis-practice\\terraform_thesis\\main.tf", "repo_file_path": "/terraform_thesis/main.tf", "file_line_range": [37, 45], "resource": "aws_instance.instance1", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.LaunchConfigurationEBSEncryption", "fixed_definition": null, "entity_tags": {"Name": "vulnerable-instance-1"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/general-13", "details": [], "check_len": null, "definition_context_file_path": "C:\\Users\\pavan\\OneDrive\\Documents\\ATU\\thesis-practice\\terraform_thesis\\main.tf"}, {"check_id": "CKV_AWS_62", "bc_check_id": "BC_AWS_IAM_47", "check_name": "Ensure IAM policies that allow full \"*-*\" administrative privileges are not created", "check_result": {"result": "FAILED", "evaluated_keys": ["policy", "inline_policy"]}, "code_block": [[56, "resource \"aws_iam_policy\" \"example\" {\n"], [57, "  name = \"example-policy\"\n"], [58, "  \n"], [59, "  policy = <<EOF\n"], [60, "{\n"], [61, "  \"Version\": \"2012-10-17\",\n"], [62, "  \"Statement\": [\n"], [63, "    {\n"], [64, "      \"Effect\": \"Allow\",\n"], [65, "      \"Action\": \"*\",  # Wildcard permissions\n"], [66, "      \"Resource\": \"*\"\n"], [67, "    }\n"], [68, "  ]\n"], [69, "}\n"], [70, "EOF\n"], [71, "\n"], [72, "  tags = {\n"], [73, "    Name = \"vulnerable-policy\"\n"], [74, "  }\n"], [75, "}"]], "file_path": "\\main.tf", "file_abs_path": "C:\\Users\\pavan\\OneDrive\\Documents\\ATU\\thesis-practice\\terraform_thesis\\main.tf", "repo_file_path": "/terraform_thesis/main.tf", "file_line_range": [56, 75], "resource": "aws_iam_policy.example", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMAdminPolicyDocument", "fixed_definition": null, "entity_tags": {"Name": "vulnerable-policy"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-iam-45", "details": [], "check_len": null, "definition_context_file_path": "C:\\Users\\pavan\\OneDrive\\Documents\\ATU\\thesis-practice\\terraform_thesis\\main.tf"}, {"check_id": "CKV_AWS_287", "bc_check_id": "BC_AWS_IAM_82", "check_name": "Ensure IAM policies does not allow credentials exposure", "check_result": {"result": "FAILED", "evaluated_keys": []}, "code_block": [[56, "resource \"aws_iam_policy\" \"example\" {\n"], [57, "  name = \"example-policy\"\n"], [58, "  \n"], [59, "  policy = <<EOF\n"], [60, "{\n"], [61, "  \"Version\": \"2012-10-17\",\n"], [62, "  \"Statement\": [\n"], [63, "    {\n"], [64, "      \"Effect\": \"Allow\",\n"], [65, "      \"Action\": \"*\",  # Wildcard permissions\n"], [66, "      \"Resource\": \"*\"\n"], [67, "    }\n"], [68, "  ]\n"], [69, "}\n"], [70, "EOF\n"], [71, "\n"], [72, "  tags = {\n"], [73, "    Name = \"vulnerable-policy\"\n"], [74, "  }\n"], [75, "}"]], "file_path": "\\main.tf", "file_abs_path": "C:\\Users\\pavan\\OneDrive\\Documents\\ATU\\thesis-practice\\terraform_thesis\\main.tf", "repo_file_path": "/terraform_thesis/main.tf", "file_line_range": [56, 75], "resource": "aws_iam_policy.example", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMCredentialsExposure", "fixed_definition": null, "entity_tags": {"Name": "vulnerable-policy"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-287", "details": [], "check_len": null, "definition_context_file_path": "C:\\Users\\pavan\\OneDrive\\Documents\\ATU\\thesis-practice\\terraform_thesis\\main.tf"}, {"check_id": "CKV_AWS_288", "bc_check_id": "BC_AWS_IAM_83", "check_name": "Ensure IAM policies does not allow data exfiltration", "check_result": {"result": "FAILED", "evaluated_keys": []}, "code_block": [[56, "resource \"aws_iam_policy\" \"example\" {\n"], [57, "  name = \"example-policy\"\n"], [58, "  \n"], [59, "  policy = <<EOF\n"], [60, "{\n"], [61, "  \"Version\": \"2012-10-17\",\n"], [62, "  \"Statement\": [\n"], [63, "    {\n"], [64, "      \"Effect\": \"Allow\",\n"], [65, "      \"Action\": \"*\",  # Wildcard permissions\n"], [66, "      \"Resource\": \"*\"\n"], [67, "    }\n"], [68, "  ]\n"], [69, "}\n"], [70, "EOF\n"], [71, "\n"], [72, "  tags = {\n"], [73, "    Name = \"vulnerable-policy\"\n"], [74, "  }\n"], [75, "}"]], "file_path": "\\main.tf", "file_abs_path": "C:\\Users\\pavan\\OneDrive\\Documents\\ATU\\thesis-practice\\terraform_thesis\\main.tf", "repo_file_path": "/terraform_thesis/main.tf", "file_line_range": [56, 75], "resource": "aws_iam_policy.example", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMDataExfiltration", "fixed_definition": null, "entity_tags": {"Name": "vulnerable-policy"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-288", "details": [], "check_len": null, "definition_context_file_path": "C:\\Users\\pavan\\OneDrive\\Documents\\ATU\\thesis-practice\\terraform_thesis\\main.tf"}, {"check_id": "CKV_AWS_289", "bc_check_id": "BC_AWS_IAM_84", "check_name": "Ensure IAM policies does not allow permissions management / resource exposure without constraints", "check_result": {"result": "FAILED", "evaluated_keys": []}, "code_block": [[56, "resource \"aws_iam_policy\" \"example\" {\n"], [57, "  name = \"example-policy\"\n"], [58, "  \n"], [59, "  policy = <<EOF\n"], [60, "{\n"], [61, "  \"Version\": \"2012-10-17\",\n"], [62, "  \"Statement\": [\n"], [63, "    {\n"], [64, "      \"Effect\": \"Allow\",\n"], [65, "      \"Action\": \"*\",  # Wildcard permissions\n"], [66, "      \"Resource\": \"*\"\n"], [67, "    }\n"], [68, "  ]\n"], [69, "}\n"], [70, "EOF\n"], [71, "\n"], [72, "  tags = {\n"], [73, "    Name = \"vulnerable-policy\"\n"], [74, "  }\n"], [75, "}"]], "file_path": "\\main.tf", "file_abs_path": "C:\\Users\\pavan\\OneDrive\\Documents\\ATU\\thesis-practice\\terraform_thesis\\main.tf", "repo_file_path": "/terraform_thesis/main.tf", "file_line_range": [56, 75], "resource": "aws_iam_policy.example", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMPermissionsManagement", "fixed_definition": null, "entity_tags": {"Name": "vulnerable-policy"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-289", "details": [], "check_len": null, "definition_context_file_path": "C:\\Users\\pavan\\OneDrive\\Documents\\ATU\\thesis-practice\\terraform_thesis\\main.tf"}, {"check_id": "CKV_AWS_286", "bc_check_id": "BC_AWS_IAM_81", "check_name": "Ensure IAM policies does not allow privilege escalation", "check_result": {"result": "FAILED", "evaluated_keys": []}, "code_block": [[56, "resource \"aws_iam_policy\" \"example\" {\n"], [57, "  name = \"example-policy\"\n"], [58, "  \n"], [59, "  policy = <<EOF\n"], [60, "{\n"], [61, "  \"Version\": \"2012-10-17\",\n"], [62, "  \"Statement\": [\n"], [63, "    {\n"], [64, "      \"Effect\": \"Allow\",\n"], [65, "      \"Action\": \"*\",  # Wildcard permissions\n"], [66, "      \"Resource\": \"*\"\n"], [67, "    }\n"], [68, "  ]\n"], [69, "}\n"], [70, "EOF\n"], [71, "\n"], [72, "  tags = {\n"], [73, "    Name = \"vulnerable-policy\"\n"], [74, "  }\n"], [75, "}"]], "file_path": "\\main.tf", "file_abs_path": "C:\\Users\\pavan\\OneDrive\\Documents\\ATU\\thesis-practice\\terraform_thesis\\main.tf", "repo_file_path": "/terraform_thesis/main.tf", "file_line_range": [56, 75], "resource": "aws_iam_policy.example", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMPrivilegeEscalation", "fixed_definition": null, "entity_tags": {"Name": "vulnerable-policy"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-286", "details": [], "check_len": null, "definition_context_file_path": "C:\\Users\\pavan\\OneDrive\\Documents\\ATU\\thesis-practice\\terraform_thesis\\main.tf"}, {"check_id": "CKV_AWS_63", "bc_check_id": "BC_AWS_IAM_48", "check_name": "Ensure no IAM policies documents allow \"*\" as a statement's actions", "check_result": {"result": "FAILED", "evaluated_keys": ["policy", "inline_policy"]}, "code_block": [[56, "resource \"aws_iam_policy\" \"example\" {\n"], [57, "  name = \"example-policy\"\n"], [58, "  \n"], [59, "  policy = <<EOF\n"], [60, "{\n"], [61, "  \"Version\": \"2012-10-17\",\n"], [62, "  \"Statement\": [\n"], [63, "    {\n"], [64, "      \"Effect\": \"Allow\",\n"], [65, "      \"Action\": \"*\",  # Wildcard permissions\n"], [66, "      \"Resource\": \"*\"\n"], [67, "    }\n"], [68, "  ]\n"], [69, "}\n"], [70, "EOF\n"], [71, "\n"], [72, "  tags = {\n"], [73, "    Name = \"vulnerable-policy\"\n"], [74, "  }\n"], [75, "}"]], "file_path": "\\main.tf", "file_abs_path": "C:\\Users\\pavan\\OneDrive\\Documents\\ATU\\thesis-practice\\terraform_thesis\\main.tf", "repo_file_path": "/terraform_thesis/main.tf", "file_line_range": [56, 75], "resource": "aws_iam_policy.example", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMStarActionPolicyDocument", "fixed_definition": null, "entity_tags": {"Name": "vulnerable-policy"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/iam-48", "details": [], "check_len": null, "definition_context_file_path": "C:\\Users\\pavan\\OneDrive\\Documents\\ATU\\thesis-practice\\terraform_thesis\\main.tf"}, {"check_id": "CKV_AWS_355", "bc_check_id": "BC_AWS_IAM_88", "check_name": "Ensure no IAM policies documents allow \"*\" as a statement's resource for restrictable actions", "check_result": {"result": "FAILED", "evaluated_keys": []}, "code_block": [[56, "resource \"aws_iam_policy\" \"example\" {\n"], [57, "  name = \"example-policy\"\n"], [58, "  \n"], [59, "  policy = <<EOF\n"], [60, "{\n"], [61, "  \"Version\": \"2012-10-17\",\n"], [62, "  \"Statement\": [\n"], [63, "    {\n"], [64, "      \"Effect\": \"Allow\",\n"], [65, "      \"Action\": \"*\",  # Wildcard permissions\n"], [66, "      \"Resource\": \"*\"\n"], [67, "    }\n"], [68, "  ]\n"], [69, "}\n"], [70, "EOF\n"], [71, "\n"], [72, "  tags = {\n"], [73, "    Name = \"vulnerable-policy\"\n"], [74, "  }\n"], [75, "}"]], "file_path": "\\main.tf", "file_abs_path": "C:\\Users\\pavan\\OneDrive\\Documents\\ATU\\thesis-practice\\terraform_thesis\\main.tf", "repo_file_path": "/terraform_thesis/main.tf", "file_line_range": [56, 75], "resource": "aws_iam_policy.example", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMStarResourcePolicyDocument", "fixed_definition": null, "entity_tags": {"Name": "vulnerable-policy"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-355", "details": [], "check_len": null, "definition_context_file_path": "C:\\Users\\pavan\\OneDrive\\Documents\\ATU\\thesis-practice\\terraform_thesis\\main.tf"}, {"check_id": "CKV_AWS_290", "bc_check_id": "BC_AWS_IAM_85", "check_name": "Ensure IAM policies does not allow write access without constraints", "check_result": {"result": "FAILED", "evaluated_keys": []}, "code_block": [[56, "resource \"aws_iam_policy\" \"example\" {\n"], [57, "  name = \"example-policy\"\n"], [58, "  \n"], [59, "  policy = <<EOF\n"], [60, "{\n"], [61, "  \"Version\": \"2012-10-17\",\n"], [62, "  \"Statement\": [\n"], [63, "    {\n"], [64, "      \"Effect\": \"Allow\",\n"], [65, "      \"Action\": \"*\",  # Wildcard permissions\n"], [66, "      \"Resource\": \"*\"\n"], [67, "    }\n"], [68, "  ]\n"], [69, "}\n"], [70, "EOF\n"], [71, "\n"], [72, "  tags = {\n"], [73, "    Name = \"vulnerable-policy\"\n"], [74, "  }\n"], [75, "}"]], "file_path": "\\main.tf", "file_abs_path": "C:\\Users\\pavan\\OneDrive\\Documents\\ATU\\thesis-practice\\terraform_thesis\\main.tf", "repo_file_path": "/terraform_thesis/main.tf", "file_line_range": [56, 75], "resource": "aws_iam_policy.example", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMWriteAccess", "fixed_definition": null, "entity_tags": {"Name": "vulnerable-policy"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-290", "details": [], "check_len": null, "definition_context_file_path": "C:\\Users\\pavan\\OneDrive\\Documents\\ATU\\thesis-practice\\terraform_thesis\\main.tf"}, {"check_id": "CKV2_AWS_41", "bc_check_id": "BC_AWS_IAM_69", "check_name": "Ensure an IAM role is attached to EC2 instance", "check_result": {"result": "FAILED", "entity": {"aws_instance": {"instance1": {"__end_line__": 45, "__start_line__": 37, "ami": ["ami-0c55b159cbfafe1f0"], "instance_type": ["t2.micro"], "subnet_id": ["aws_vpc.main.id"], "tags": [{"Name": "vulnerable-instance-1"}], "__address__": "aws_instance.instance1", "__provider_address__": "aws.default"}}}, "evaluated_keys": ["iam_instance_profile"]}, "code_block": [[37, "resource \"aws_instance\" \"instance1\" {\n"], [38, "  ami           = \"ami-0c55b159cbfafe1f0\"\n"], [39, "  instance_type = \"t2.micro\"\n"], [40, "  subnet_id     = aws_vpc.main.id\n"], [41, "\n"], [42, "  tags = {\n"], [43, "    Name = \"vulnerable-instance-1\"\n"], [44, "  }\n"], [45, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "C:\\Users\\pavan\\OneDrive\\Documents\\ATU\\thesis-practice\\terraform_thesis\\main.tf", "repo_file_path": "/terraform_thesis/main.tf", "file_line_range": [37, 45], "resource": "aws_instance.instance1", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Name": "vulnerable-instance-1"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/ensure-an-iam-role-is-attached-to-ec2-instance", "details": [], "check_len": null, "definition_context_file_path": "C:\\Users\\pavan\\OneDrive\\Documents\\ATU\\thesis-practice\\terraform_thesis\\main.tf"}, {"check_id": "CKV2_AWS_62", "bc_check_id": "BC_AWS_LOGGING_36", "check_name": "Ensure S3 buckets should have event notifications enabled", "check_result": {"result": "FAILED", "entity": {"aws_s3_bucket": {"example": {"__end_line__": 54, "__start_line__": 47, "acl": ["public-read"], "bucket": ["my-example-bucket"], "tags": [{"Name": "vulnerable-bucket"}], "__address__": "aws_s3_bucket.example", "__provider_address__": "aws.default"}}}, "evaluated_keys": ["resource_type"]}, "code_block": [[47, "resource \"aws_s3_bucket\" \"example\" {\n"], [48, "  bucket = \"my-example-bucket\"\n"], [49, "  acl    = \"public-read\"  # Publicly accessible S3 bucket\n"], [50, "\n"], [51, "  tags = {\n"], [52, "    Name = \"vulnerable-bucket\"\n"], [53, "  }\n"], [54, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "C:\\Users\\pavan\\OneDrive\\Documents\\ATU\\thesis-practice\\terraform_thesis\\main.tf", "repo_file_path": "/terraform_thesis/main.tf", "file_line_range": [47, 54], "resource": "aws_s3_bucket.example", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Name": "vulnerable-bucket"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-62", "details": [], "check_len": null, "definition_context_file_path": "C:\\Users\\pavan\\OneDrive\\Documents\\ATU\\thesis-practice\\terraform_thesis\\main.tf"}, {"check_id": "CKV2_AWS_6", "bc_check_id": "BC_AWS_NETWORKING_52", "check_name": "Ensure that S3 bucket has a Public Access block", "check_result": {"result": "FAILED", "entity": {"aws_s3_bucket": {"example": {"__end_line__": 54, "__start_line__": 47, "acl": ["public-read"], "bucket": ["my-example-bucket"], "tags": [{"Name": "vulnerable-bucket"}], "__address__": "aws_s3_bucket.example", "__provider_address__": "aws.default"}}}, "evaluated_keys": ["block_public_policy", "resource_type", "block_public_acls"]}, "code_block": [[47, "resource \"aws_s3_bucket\" \"example\" {\n"], [48, "  bucket = \"my-example-bucket\"\n"], [49, "  acl    = \"public-read\"  # Publicly accessible S3 bucket\n"], [50, "\n"], [51, "  tags = {\n"], [52, "    Name = \"vulnerable-bucket\"\n"], [53, "  }\n"], [54, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "C:\\Users\\pavan\\OneDrive\\Documents\\ATU\\thesis-practice\\terraform_thesis\\main.tf", "repo_file_path": "/terraform_thesis/main.tf", "file_line_range": [47, 54], "resource": "aws_s3_bucket.example", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Name": "vulnerable-bucket"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/s3-bucket-should-have-public-access-blocks-defaults-to-false-if-the-public-access-block-is-not-attached", "details": [], "check_len": null, "definition_context_file_path": "C:\\Users\\pavan\\OneDrive\\Documents\\ATU\\thesis-practice\\terraform_thesis\\main.tf"}, {"check_id": "CKV2_AWS_5", "bc_check_id": "BC_AWS_NETWORKING_51", "check_name": "Ensure that Security Groups are attached to another resource", "check_result": {"result": "FAILED", "entity": {"aws_security_group": {"allow_all": {"__end_line__": 35, "__start_line__": 15, "egress": [{"cidr_blocks": [["0.0.0.0/0"]], "from_port": [0], "protocol": ["-1"], "to_port": [0]}], "ingress": [{"cidr_blocks": [["0.0.0.0/0"]], "from_port": [0], "protocol": ["-1"], "to_port": [0]}], "tags": [{"Name": "allow-all"}], "vpc_id": ["aws_vpc.main.id"], "__address__": "aws_security_group.allow_all", "__provider_address__": "aws.default"}}}, "evaluated_keys": ["resource_type", "networking"]}, "code_block": [[15, "resource \"aws_security_group\" \"allow_all\" {\n"], [16, "  vpc_id = aws_vpc.main.id\n"], [17, "\n"], [18, "  ingress {\n"], [19, "    from_port   = 0\n"], [20, "    to_port     = 0\n"], [21, "    protocol    = \"-1\"\n"], [22, "    cidr_blocks = [\"0.0.0.0/0\"]  # Overly permissive rule\n"], [23, "  }\n"], [24, "\n"], [25, "  egress {\n"], [26, "    from_port   = 0\n"], [27, "    to_port     = 0\n"], [28, "    protocol    = \"-1\"\n"], [29, "    cidr_blocks = [\"0.0.0.0/0\"]  # Overly permissive rule\n"], [30, "  }\n"], [31, "\n"], [32, "  tags = {\n"], [33, "    Name = \"allow-all\"\n"], [34, "  }\n"], [35, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "C:\\Users\\pavan\\OneDrive\\Documents\\ATU\\thesis-practice\\terraform_thesis\\main.tf", "repo_file_path": "/terraform_thesis/main.tf", "file_line_range": [15, 35], "resource": "aws_security_group.allow_all", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Name": "allow-all"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/ensure-that-security-groups-are-attached-to-ec2-instances-or-elastic-network-interfaces-enis", "details": [], "check_len": null, "definition_context_file_path": "C:\\Users\\pavan\\OneDrive\\Documents\\ATU\\thesis-practice\\terraform_thesis\\main.tf"}, {"check_id": "CKV2_AWS_11", "bc_check_id": "BC_AWS_LOGGING_9", "check_name": "Ensure VPC flow logging is enabled in all VPCs", "check_result": {"result": "FAILED", "entity": {"aws_vpc": {"main": {"__end_line__": 13, "__start_line__": 7, "cidr_block": ["10.0.0.0/16"], "tags": [{"Name": "vulnerable-vpc"}], "__address__": "aws_vpc.main", "__provider_address__": "aws.default"}}}, "evaluated_keys": ["networking", "resource_type"]}, "code_block": [[7, "resource \"aws_vpc\" \"main\" {\n"], [8, "  cidr_block = \"10.0.0.0/16\"\n"], [9, "\n"], [10, "  tags = {\n"], [11, "    Name = \"vulnerable-vpc\"\n"], [12, "  }\n"], [13, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "C:\\Users\\pavan\\OneDrive\\Documents\\ATU\\thesis-practice\\terraform_thesis\\main.tf", "repo_file_path": "/terraform_thesis/main.tf", "file_line_range": [7, 13], "resource": "aws_vpc.main", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Name": "vulnerable-vpc"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/logging-9-enable-vpc-flow-logging", "details": [], "check_len": null, "definition_context_file_path": "C:\\Users\\pavan\\OneDrive\\Documents\\ATU\\thesis-practice\\terraform_thesis\\main.tf"}, {"check_id": "CKV2_AWS_12", "bc_check_id": "BC_AWS_NETWORKING_4", "check_name": "Ensure the default security group of every VPC restricts all traffic", "check_result": {"result": "FAILED", "entity": {"aws_vpc": {"main": {"__end_line__": 13, "__start_line__": 7, "cidr_block": ["10.0.0.0/16"], "tags": [{"Name": "vulnerable-vpc"}], "__address__": "aws_vpc.main", "__provider_address__": "aws.default"}}}, "evaluated_keys": ["ingress/to_port", "egress/cidr_blocks", "ingress/from_port", "egress/to_port", "ingress/protocol", "egress/from_port", "ingress/self", "resource_type", "egress/protocol"]}, "code_block": [[7, "resource \"aws_vpc\" \"main\" {\n"], [8, "  cidr_block = \"10.0.0.0/16\"\n"], [9, "\n"], [10, "  tags = {\n"], [11, "    Name = \"vulnerable-vpc\"\n"], [12, "  }\n"], [13, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "C:\\Users\\pavan\\OneDrive\\Documents\\ATU\\thesis-practice\\terraform_thesis\\main.tf", "repo_file_path": "/terraform_thesis/main.tf", "file_line_range": [7, 13], "resource": "aws_vpc.main", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Name": "vulnerable-vpc"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/networking-4", "details": [], "check_len": null, "definition_context_file_path": "C:\\Users\\pavan\\OneDrive\\Documents\\ATU\\thesis-practice\\terraform_thesis\\main.tf"}, {"check_id": "CKV_AWS_21", "bc_check_id": "BC_AWS_S3_16", "check_name": "Ensure all data stored in the S3 bucket have versioning enabled", "check_result": {"result": "FAILED", "entity": {"aws_s3_bucket": {"example": {"__end_line__": 54, "__start_line__": 47, "acl": ["public-read"], "bucket": ["my-example-bucket"], "tags": [{"Name": "vulnerable-bucket"}], "__address__": "aws_s3_bucket.example", "__provider_address__": "aws.default"}}}, "evaluated_keys": ["resource_type", "versioning/enabled", "versioning_configuration/status"]}, "code_block": [[47, "resource \"aws_s3_bucket\" \"example\" {\n"], [48, "  bucket = \"my-example-bucket\"\n"], [49, "  acl    = \"public-read\"  # Publicly accessible S3 bucket\n"], [50, "\n"], [51, "  tags = {\n"], [52, "    Name = \"vulnerable-bucket\"\n"], [53, "  }\n"], [54, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "C:\\Users\\pavan\\OneDrive\\Documents\\ATU\\thesis-practice\\terraform_thesis\\main.tf", "repo_file_path": "/terraform_thesis/main.tf", "file_line_range": [47, 54], "resource": "aws_s3_bucket.example", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Name": "vulnerable-bucket"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/s3-16-enable-versioning", "details": [], "check_len": null, "definition_context_file_path": "C:\\Users\\pavan\\OneDrive\\Documents\\ATU\\thesis-practice\\terraform_thesis\\main.tf"}, {"check_id": "CKV_AWS_20", "bc_check_id": "BC_AWS_S3_1", "check_name": "S3 Bucket has an ACL defined which allows public READ access.", "check_result": {"result": "FAILED", "entity": {"aws_s3_bucket": {"example": {"__end_line__": 54, "__start_line__": 47, "acl": ["public-read"], "bucket": ["my-example-bucket"], "tags": [{"Name": "vulnerable-bucket"}], "__address__": "aws_s3_bucket.example", "__provider_address__": "aws.default"}}}, "evaluated_keys": ["access_control_policy/grant", "acl", "access_control_policy", "access_control_policy/grant/*/grantee/uri", "resource_type"]}, "code_block": [[47, "resource \"aws_s3_bucket\" \"example\" {\n"], [48, "  bucket = \"my-example-bucket\"\n"], [49, "  acl    = \"public-read\"  # Publicly accessible S3 bucket\n"], [50, "\n"], [51, "  tags = {\n"], [52, "    Name = \"vulnerable-bucket\"\n"], [53, "  }\n"], [54, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "C:\\Users\\pavan\\OneDrive\\Documents\\ATU\\thesis-practice\\terraform_thesis\\main.tf", "repo_file_path": "/terraform_thesis/main.tf", "file_line_range": [47, 54], "resource": "aws_s3_bucket.example", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Name": "vulnerable-bucket"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/s3-1-acl-read-permissions-everyone", "details": [], "check_len": null, "definition_context_file_path": "C:\\Users\\pavan\\OneDrive\\Documents\\ATU\\thesis-practice\\terraform_thesis\\main.tf"}, {"check_id": "CKV2_AWS_61", "bc_check_id": "BC_AWS_LOGGING_35", "check_name": "Ensure that an S3 bucket has a lifecycle configuration", "check_result": {"result": "FAILED", "entity": {"aws_s3_bucket": {"example": {"__end_line__": 54, "__start_line__": 47, "acl": ["public-read"], "bucket": ["my-example-bucket"], "tags": [{"Name": "vulnerable-bucket"}], "__address__": "aws_s3_bucket.example", "__provider_address__": "aws.default"}}}, "evaluated_keys": ["resource_type", "lifecycle_rule"]}, "code_block": [[47, "resource \"aws_s3_bucket\" \"example\" {\n"], [48, "  bucket = \"my-example-bucket\"\n"], [49, "  acl    = \"public-read\"  # Publicly accessible S3 bucket\n"], [50, "\n"], [51, "  tags = {\n"], [52, "    Name = \"vulnerable-bucket\"\n"], [53, "  }\n"], [54, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "C:\\Users\\pavan\\OneDrive\\Documents\\ATU\\thesis-practice\\terraform_thesis\\main.tf", "repo_file_path": "/terraform_thesis/main.tf", "file_line_range": [47, 54], "resource": "aws_s3_bucket.example", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Name": "vulnerable-bucket"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61", "details": [], "check_len": null, "definition_context_file_path": "C:\\Users\\pavan\\OneDrive\\Documents\\ATU\\thesis-practice\\terraform_thesis\\main.tf"}, {"check_id": "CKV_AWS_18", "bc_check_id": "BC_AWS_S3_13", "check_name": "Ensure the S3 bucket has access logging enabled", "check_result": {"result": "FAILED", "entity": {"aws_s3_bucket": {"example": {"__end_line__": 54, "__start_line__": 47, "acl": ["public-read"], "bucket": ["my-example-bucket"], "tags": [{"Name": "vulnerable-bucket"}], "__address__": "aws_s3_bucket.example", "__provider_address__": "aws.default"}}}, "evaluated_keys": ["logging", "resource_type"]}, "code_block": [[47, "resource \"aws_s3_bucket\" \"example\" {\n"], [48, "  bucket = \"my-example-bucket\"\n"], [49, "  acl    = \"public-read\"  # Publicly accessible S3 bucket\n"], [50, "\n"], [51, "  tags = {\n"], [52, "    Name = \"vulnerable-bucket\"\n"], [53, "  }\n"], [54, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "C:\\Users\\pavan\\OneDrive\\Documents\\ATU\\thesis-practice\\terraform_thesis\\main.tf", "repo_file_path": "/terraform_thesis/main.tf", "file_line_range": [47, 54], "resource": "aws_s3_bucket.example", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Name": "vulnerable-bucket"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/s3-13-enable-logging", "details": [], "check_len": null, "definition_context_file_path": "C:\\Users\\pavan\\OneDrive\\Documents\\ATU\\thesis-practice\\terraform_thesis\\main.tf"}, {"check_id": "CKV_AWS_145", "bc_check_id": "BC_AWS_GENERAL_56", "check_name": "Ensure that S3 buckets are encrypted with KMS by default", "check_result": {"result": "FAILED", "entity": {"aws_s3_bucket": {"example": {"__end_line__": 54, "__start_line__": 47, "acl": ["public-read"], "bucket": ["my-example-bucket"], "tags": [{"Name": "vulnerable-bucket"}], "__address__": "aws_s3_bucket.example", "__provider_address__": "aws.default"}}}, "evaluated_keys": ["rule/apply_server_side_encryption_by_default/sse_algorithm", "resource_type", "server_side_encryption_configuration/rule/apply_server_side_encryption_by_default/sse_algorithm"]}, "code_block": [[47, "resource \"aws_s3_bucket\" \"example\" {\n"], [48, "  bucket = \"my-example-bucket\"\n"], [49, "  acl    = \"public-read\"  # Publicly accessible S3 bucket\n"], [50, "\n"], [51, "  tags = {\n"], [52, "    Name = \"vulnerable-bucket\"\n"], [53, "  }\n"], [54, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "C:\\Users\\pavan\\OneDrive\\Documents\\ATU\\thesis-practice\\terraform_thesis\\main.tf", "repo_file_path": "/terraform_thesis/main.tf", "file_line_range": [47, 54], "resource": "aws_s3_bucket.example", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Name": "vulnerable-bucket"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-s3-buckets-are-encrypted-with-kms-by-default", "details": [], "check_len": null, "definition_context_file_path": "C:\\Users\\pavan\\OneDrive\\Documents\\ATU\\thesis-practice\\terraform_thesis\\main.tf"}, {"check_id": "CKV_AWS_144", "bc_check_id": "BC_AWS_GENERAL_72", "check_name": "Ensure that S3 bucket has cross-region replication enabled", "check_result": {"result": "FAILED", "entity": {"aws_s3_bucket": {"example": {"__end_line__": 54, "__start_line__": 47, "acl": ["public-read"], "bucket": ["my-example-bucket"], "tags": [{"Name": "vulnerable-bucket"}], "__address__": "aws_s3_bucket.example", "__provider_address__": "aws.default"}}}, "evaluated_keys": ["resource_type", "replication_configuration/rules/*/status", "rule/*/status"]}, "code_block": [[47, "resource \"aws_s3_bucket\" \"example\" {\n"], [48, "  bucket = \"my-example-bucket\"\n"], [49, "  acl    = \"public-read\"  # Publicly accessible S3 bucket\n"], [50, "\n"], [51, "  tags = {\n"], [52, "    Name = \"vulnerable-bucket\"\n"], [53, "  }\n"], [54, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "C:\\Users\\pavan\\OneDrive\\Documents\\ATU\\thesis-practice\\terraform_thesis\\main.tf", "repo_file_path": "/terraform_thesis/main.tf", "file_line_range": [47, 54], "resource": "aws_s3_bucket.example", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Name": "vulnerable-bucket"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-s3-bucket-has-cross-region-replication-enabled", "details": [], "check_len": null, "definition_context_file_path": "C:\\Users\\pavan\\OneDrive\\Documents\\ATU\\thesis-practice\\terraform_thesis\\main.tf"}, {"check_id": "CKV2_AWS_40", "bc_check_id": "BC_AWS_IAM_73", "check_name": "Ensure AWS IAM policy does not allow full IAM privileges", "check_result": {"result": "FAILED", "entity": {"aws_iam_policy": {"example": {"__end_line__": 75, "__start_line__": 56, "name": ["example-policy"], "policy": [{"Version": "2012-10-17", "Statement": [{"Effect": "Allow", "Action": "*", "Resource": "*"}]}], "tags": [{"Name": "vulnerable-policy"}], "__address__": "aws_iam_policy.example", "__provider_address__": "aws.default"}}}, "evaluated_keys": ["policy/Statement[?(@/Effect == Allow)]/Action[*]", "statement[?(@/effect == Allow)]/actions[*]", "inline_policy/Statement[?(@/Effect == Allow)]/Action[*]"]}, "code_block": [[56, "resource \"aws_iam_policy\" \"example\" {\n"], [57, "  name = \"example-policy\"\n"], [58, "  \n"], [59, "  policy = <<EOF\n"], [60, "{\n"], [61, "  \"Version\": \"2012-10-17\",\n"], [62, "  \"Statement\": [\n"], [63, "    {\n"], [64, "      \"Effect\": \"Allow\",\n"], [65, "      \"Action\": \"*\",  # Wildcard permissions\n"], [66, "      \"Resource\": \"*\"\n"], [67, "    }\n"], [68, "  ]\n"], [69, "}\n"], [70, "EOF\n"], [71, "\n"], [72, "  tags = {\n"], [73, "    Name = \"vulnerable-policy\"\n"], [74, "  }\n"], [75, "}"]], "file_path": "\\main.tf", "file_abs_path": "C:\\Users\\pavan\\OneDrive\\Documents\\ATU\\thesis-practice\\terraform_thesis\\main.tf", "repo_file_path": "/terraform_thesis/main.tf", "file_line_range": [56, 75], "resource": "aws_iam_policy.example", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Name": "vulnerable-policy"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-2-40", "details": [], "check_len": null, "definition_context_file_path": "C:\\Users\\pavan\\OneDrive\\Documents\\ATU\\thesis-practice\\terraform_thesis\\main.tf"}], "skipped_checks": [], "parsing_errors": []}, "summary": {"passed": 6, "failed": 30, "skipped": 0, "parsing_errors": 0, "resource_count": 5, "checkov_version": "3.2.217"}, "url": "Add an api key '--bc-api-key <api-key>' to see more detailed insights via https://bridgecrew.cloud"}